<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="XiaoMa">
    
    <title>
        
            Python 爬虫入门 |
        
        Story Begins……
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/logo.png">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/logo.png","favicon":"https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/logo.png","avatar":"https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/avatar.png","font_size":null,"font_family":null,"hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"Less than Zero || Do not Go Gentle into that Good Night","font_color":null,"hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"obsidian"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":false},"comment":{"enable":false,"use":"waline","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":false,"custom_label_list":["博士生"]},"word_count":{"enable":true,"wordcount":true,"min2read":false},"img_align":"center","copyright_info":true},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="null" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/logo.png">
                </a>
            
            <a class="logo-title" href="/">
               Story Begins……
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                友链
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">友链</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">Python 爬虫入门</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/avatar.png">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">XiaoMa</span>
                            
                                <span class="author-label">博士生</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2023-03-09 11:13:09</span>
        <span class="mobile">2023-03-09 11:13</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2023-04-14 04:13:23</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Python/">Python</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E7%88%AC%E8%99%AB/">爬虫</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E8%B1%86%E7%93%A3/">豆瓣</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>4.1k 字</span>
        </span>
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <p>爬虫扫盲练习。</p>
<h3 id="实战练习：豆瓣电影-TOP250"><a href="#实战练习：豆瓣电影-TOP250" class="headerlink" title="实战练习：豆瓣电影 TOP250"></a>实战练习：豆瓣电影 TOP250</h3><p>源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36 Edg/110.0.1587.63&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> start_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line">    response = requests.get(<span class="string">f&quot;https://movie.douban.com/top250?start=<span class="subst">&#123;start_num&#125;</span>&quot;</span>, headers=header)</span><br><span class="line">    html = response.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>) <span class="comment">#html.parser 是一个解析器</span></span><br><span class="line"></span><br><span class="line">    all_titles = soup.findAll(<span class="string">&quot;span&quot;</span>, attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;title&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">for</span> title <span class="keyword">in</span> all_titles:</span><br><span class="line">        title_string = title.string</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> title_string:</span><br><span class="line">            <span class="built_in">print</span>(title_string)</span><br></pre></td></tr></table></figure>

<h3 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h3><ol>
<li><p>安装 <code>Requests</code> 和 <code>BeautifulSoup</code> 库。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install Requests</span><br><span class="line">pip install BeautifulSoup</span><br></pre></td></tr></table></figure>
</li>
<li><p>导入 <code>Requests</code> 库，并爬取豆瓣电影 TOP250</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&quot;https://movie.douban.com/top250&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response.status_code) <span class="comment">#直接打印 response 或 response.status_code 都可以</span></span><br></pre></td></tr></table></figure>

<p>运行代码，返回 418，表示豆瓣不想理你。</p>
</li>
<li><p>加入请求头（headers）将代码伪装成浏览器。</p>
<ul>
<li><p>浏览器打开<a class="link"   target="_blank" rel="noopener" href="https://movie.douban.com/top250" >豆瓣电影 Top 250 (douban.com)<i class="fas fa-external-link-alt"></i></a>，点击右键→选择【检查】→选择【网络】，在【名称】中找到【top250】，查看【标头】→【请求标头】→【User-Agent】，复制冒号后面的内容。</p>
<img src="https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/image-20230309114243919.png" alt="image-20230309114243919" style="zoom:50%;" />
</li>
<li><p>在代码中加入 headers。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36 Edg/110.0.1587.63&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&quot;https://movie.douban.com/top250&quot;</span>, headers=header)</span><br><span class="line"><span class="built_in">print</span>(response.status_code) <span class="comment">#返回值 200，表示正常访问</span></span><br><span class="line"><span class="built_in">print</span>(response.text) <span class="comment">#可以看到打印下来 HTML 代码</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可以把 reponse.text 的返回值命名为 html，使用 BeautifulSoup 去解析，返回值命名为 soup，然后调用 soup 的属性 findAll，返回值命名为 all_title。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36 Edg/110.0.1587.63&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&quot;https://movie.douban.com/top250&quot;</span>, headers=header)</span><br><span class="line">html = response.text</span><br><span class="line">soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">all_titles = soup.findAll(<span class="string">&quot;span&quot;</span>, attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;title&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">for</span> title <span class="keyword">in</span> all_titles:</span><br><span class="line">	<span class="built_in">print</span>(title) </span><br><span class="line">---    </span><br><span class="line"><span class="comment">#打印结果 </span></span><br><span class="line">&lt;span <span class="keyword">class</span>=<span class="string">&quot;title&quot;</span>&gt;疯狂动物城&lt;/span&gt;</span><br><span class="line">&lt;span <span class="keyword">class</span>=<span class="string">&quot;title&quot;</span>&gt; / Zootopia&lt;/span&gt;</span><br><span class="line">---</span><br><span class="line"><span class="comment">#如果只想要文字元素，则改为</span></span><br><span class="line"><span class="keyword">for</span> title <span class="keyword">in</span> all_titles:</span><br><span class="line">	<span class="built_in">print</span>（title.string)</span><br><span class="line">---</span><br><span class="line"><span class="comment">#打印结果</span></span><br><span class="line">疯狂动物城</span><br><span class="line"> / Zootopia</span><br><span class="line">---</span><br><span class="line"><span class="comment">#这时候会有原名，分析发现原名前面都有 /，使用 if 语句判断，即可剔除掉</span></span><br><span class="line"><span class="keyword">for</span> title <span class="keyword">in</span> all_titles:</span><br><span class="line">    title_string = title.string</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> title_string:</span><br><span class="line">        <span class="built_in">print</span>(title_string)</span><br><span class="line">---</span><br><span class="line"><span class="comment">#打印结果</span></span><br><span class="line">疯狂动物城</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
</li>
<li><p>我们注意到，这里只打印了前 25 个结果，如果想要打印 250 个结果，那么就要分析网站地址，发现第二页的网站地址是这样的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://movie.douban.com/top250?start=25&amp;filter=</span><br></pre></td></tr></table></figure>

<p>在后面写上 <code>?start=xx</code> 即可。于是可以写一个 for 循环来完成：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> start_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line">    <span class="built_in">print</span>(start_num)</span><br><span class="line">---</span><br><span class="line"><span class="comment">#打印结果</span></span><br><span class="line"><span class="number">0</span> <span class="number">25</span> <span class="number">50</span> …… <span class="number">225</span></span><br></pre></td></tr></table></figure>

<p>将 <code>request.get()</code> 里面的网址字符串格式化。<code>f</code> 表示字符串格式化，它可以将大括号 {} 中的变量值替换为实际的值。在这个网址中，<code>&#123;start_num&#125;</code> 会被替换为实际的数字，从而实现动态生成网址的功能。</p>
<p>再将前面打印前 25 电影名的代码，写进 for 循环体。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> start_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line">    response = requests.get(<span class="string">f&quot;https://movie.douban.com/top250?start=<span class="subst">&#123;start_num&#125;</span>&quot;</span>, headers=header)</span><br><span class="line">    html = response.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">    all_titles = soup.findAll(<span class="string">&quot;span&quot;</span>, attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;title&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">for</span> title <span class="keyword">in</span> all_titles:</span><br><span class="line">        title_string = title.string</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> title_string:</span><br><span class="line">            <span class="built_in">print</span>(title_string)</span><br><span class="line">---</span><br><span class="line"><span class="comment">#打印结果</span></span><br><span class="line">肖申克的救赎</span><br><span class="line">霸王别姬</span><br><span class="line">阿甘正传</span><br><span class="line">泰坦尼克号</span><br><span class="line">这个杀手不太冷</span><br><span class="line">…… （一直到第 <span class="number">250</span> 个）</span><br></pre></td></tr></table></figure>
</li>
<li><p>完成！</p>
</li>
</ol>
<h3 id="拓展练习"><a href="#拓展练习" class="headerlink" title="拓展练习"></a>拓展练习</h3><p>以上是根据 B 站一位 Up 主的教程，手把手教着写的。现在只是在终端里打印下来了这 250 个名字，如果我想要做个表格，有序号、中文名、原名、年份、评分、时长、简介。于是开始折腾……</p>
<h4 id="加入了电影原名（第-3-列）"><a href="#加入了电影原名（第-3-列）" class="headerlink" title="加入了电影原名（第 3 列）"></a>加入了电影原名（第 3 列）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36 Edg/110.0.1587.63&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wb = Workbook()</span><br><span class="line">ws = wb.active</span><br><span class="line">ws.title = <span class="string">&quot;豆瓣电影TOP250&quot;</span></span><br><span class="line">ws[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;序号&quot;</span></span><br><span class="line">ws[<span class="string">&quot;B1&quot;</span>] = <span class="string">&quot;电影名称&quot;</span></span><br><span class="line">ws[<span class="string">&quot;C1&quot;</span>] = <span class="string">&quot;电影原名&quot;</span></span><br><span class="line">ws[<span class="string">&quot;D1&quot;</span>] = <span class="string">&quot;其他名称&quot;</span></span><br><span class="line"></span><br><span class="line">row_num = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> start_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">    response = requests.get(<span class="string">f&quot;https://movie.douban.com/top250?start=<span class="subst">&#123;start_num&#125;</span>&quot;</span>, headers=header)</span><br><span class="line">    html = response.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line">    all_titles = soup.findAll(<span class="string">&quot;span&quot;</span>, attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;title&quot;</span>&#125;)</span><br><span class="line">    all_other_titles = soup.findAll(<span class="string">&quot;span&quot;</span>, attrs=&#123;<span class="string">&quot;class&quot;</span>: <span class="string">&quot;other&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">for</span> i, title <span class="keyword">in</span> <span class="built_in">enumerate</span>(all_titles):</span><br><span class="line">        title_string = title.string</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> title_string:</span><br><span class="line">            ws.cell(row=row_num, column=<span class="number">1</span>, value=i+<span class="number">1</span>+start_num)</span><br><span class="line">            ws.cell(row=row_num, column=<span class="number">2</span>, value=title_string)</span><br><span class="line">            last_row_num = row_num</span><br><span class="line">            row_num += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ws.cell(row=last_row_num, column=<span class="number">3</span>, value=title_string.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">1</span>].strip())</span><br><span class="line"></span><br><span class="line">wb.save(<span class="string">&quot;douban_top250_5.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>

<img src="https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/image-20230309200814225.png" alt="image-20230309200814225" style="zoom:91.5%;" />

<h4 id="又加入了别名（第-4-列）"><a href="#又加入了别名（第-4-列）" class="headerlink" title="又加入了别名（第 4 列）"></a>又加入了别名（第 4 列）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36 Edg/110.0.1587.63&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wb = Workbook()</span><br><span class="line">ws = wb.active</span><br><span class="line">ws.title = <span class="string">&quot;豆瓣电影TOP250&quot;</span></span><br><span class="line">ws[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;序号&quot;</span></span><br><span class="line">ws[<span class="string">&quot;B1&quot;</span>] = <span class="string">&quot;电影名称&quot;</span></span><br><span class="line">ws[<span class="string">&quot;C1&quot;</span>] = <span class="string">&quot;电影原名&quot;</span></span><br><span class="line">ws[<span class="string">&quot;D1&quot;</span>] = <span class="string">&quot;其他名称&quot;</span></span><br><span class="line"></span><br><span class="line">row_num = <span class="number">2</span></span><br><span class="line">last_row_num = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> start_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">    response = requests.get(<span class="string">f&quot;https://movie.douban.com/top250?start=<span class="subst">&#123;start_num&#125;</span>&quot;</span>, headers=header)</span><br><span class="line">    html = response.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line">    all_elements = soup.findAll(<span class="string">&quot;span&quot;</span>, attrs=&#123;<span class="string">&quot;class&quot;</span>: [<span class="string">&quot;title&quot;</span>, <span class="string">&quot;other&quot;</span>, <span class="string">&quot;&quot;</span>]&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, element <span class="keyword">in</span> <span class="built_in">enumerate</span>(all_elements):</span><br><span class="line">        element_string = element.string</span><br><span class="line">        ws.cell(row=row_num, column=<span class="number">1</span>, value=i+<span class="number">1</span>+start_num)</span><br><span class="line">        <span class="keyword">if</span> element.has_attr(<span class="string">&quot;class&quot;</span>) <span class="keyword">and</span> <span class="string">&quot;other&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            element_string = re.sub(<span class="string">r&quot;\s*/\s*&quot;</span>, <span class="string">&quot;&quot;</span>, element_string, count=<span class="number">1</span>)</span><br><span class="line">            element_string = re.sub(<span class="string">r&quot;\s*/\s*&quot;</span>, <span class="string">&quot;/&quot;</span>, element_string, count=<span class="number">1</span>)</span><br><span class="line">            ws.cell(row = last_row_num, column = <span class="number">4</span>, value=element_string)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> element_string:</span><br><span class="line">                ws.cell(row=row_num, column=<span class="number">2</span>, value=element_string)</span><br><span class="line">                last_row_num = row_num</span><br><span class="line">                row_num += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">3</span>, value=element_string.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">1</span>].strip())</span><br><span class="line"></span><br><span class="line">wb.save(<span class="string">&quot;douban_top250_18.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="又加入了年份、国家（第-5、6-列）"><a href="#又加入了年份、国家（第-5、6-列）" class="headerlink" title="又加入了年份、国家（第 5、6 列）"></a>又加入了年份、国家（第 5、6 列）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36 Edg/110.0.1587.63&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wb = Workbook()</span><br><span class="line">ws = wb.active</span><br><span class="line">ws.title = <span class="string">&quot;豆瓣电影TOP250&quot;</span></span><br><span class="line">ws[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;序号&quot;</span></span><br><span class="line">ws[<span class="string">&quot;B1&quot;</span>] = <span class="string">&quot;电影名称&quot;</span></span><br><span class="line">ws[<span class="string">&quot;C1&quot;</span>] = <span class="string">&quot;电影原名&quot;</span></span><br><span class="line">ws[<span class="string">&quot;D1&quot;</span>] = <span class="string">&quot;其他名称&quot;</span></span><br><span class="line">ws[<span class="string">&quot;E1&quot;</span>] = <span class="string">&quot;年份&quot;</span></span><br><span class="line">ws[<span class="string">&quot;F1&quot;</span>] = <span class="string">&quot;国家&quot;</span></span><br><span class="line">ws[<span class="string">&quot;G1&quot;</span>] = <span class="string">&quot;评分&quot;</span></span><br><span class="line">ws[<span class="string">&quot;H1&quot;</span>] = <span class="string">&quot;简介&quot;</span></span><br><span class="line"></span><br><span class="line">row_num = <span class="number">2</span></span><br><span class="line">last_row_num = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> start_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">    response = requests.get(<span class="string">f&quot;https://movie.douban.com/top250?start=<span class="subst">&#123;start_num&#125;</span>&quot;</span>, headers=header)</span><br><span class="line">    html = response.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line">    all_elements = soup.select(<span class="string">&quot;p, span.title, span.other&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> all_elements:</span><br><span class="line">        element_string = element.string</span><br><span class="line">        <span class="keyword">if</span> element.name == <span class="string">&quot;p&quot;</span>:</span><br><span class="line">            text = element.text.strip()</span><br><span class="line">            <span class="keyword">match</span> = re.search(<span class="string">r&quot;\d&#123;4&#125;\s*/\s*\S+&quot;</span>, text)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                year_country = <span class="keyword">match</span>.group(<span class="number">0</span>)</span><br><span class="line">                year, country = <span class="built_in">map</span>(<span class="built_in">str</span>.strip, year_country.split(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">5</span>, value=year)</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">6</span>, value=country)</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;title&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> element_string:</span><br><span class="line">                ws.cell(row=row_num, column=<span class="number">2</span>, value=element_string)</span><br><span class="line">                last_row_num = row_num</span><br><span class="line">                row_num += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">3</span>, value=element_string.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">1</span>].strip())</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;other&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            element_string = element.text.strip()</span><br><span class="line">            element_string = re.sub(<span class="string">r&quot;\s*/\s*&quot;</span>, <span class="string">&quot;&quot;</span>, element_string, count=<span class="number">1</span>)</span><br><span class="line">            element_string = re.sub(<span class="string">r&quot;\s+&quot;</span>, <span class="string">&quot;&quot;</span>, element_string)</span><br><span class="line">            ws.cell(row = last_row_num, column = <span class="number">4</span>, value=element_string)</span><br><span class="line"></span><br><span class="line">wb.save(<span class="string">&quot;douban_top250_20.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="又加入了简介（第-7-列）"><a href="#又加入了简介（第-7-列）" class="headerlink" title="又加入了简介（第 7 列）"></a>又加入了简介（第 7 列）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re <span class="comment">#用于正则匹配</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook <span class="comment">#用于生成 Excel 表格</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#加入请求头，伪装成浏览器</span></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36 Edg/110.0.1587.63&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#表头</span></span><br><span class="line">wb = Workbook()</span><br><span class="line">ws = wb.active</span><br><span class="line">ws.title = <span class="string">&quot;豆瓣电影TOP250&quot;</span> <span class="comment">#这张表格的名字，在左下角显示</span></span><br><span class="line">ws[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;序号&quot;</span></span><br><span class="line">ws[<span class="string">&quot;B1&quot;</span>] = <span class="string">&quot;电影名称&quot;</span></span><br><span class="line">ws[<span class="string">&quot;C1&quot;</span>] = <span class="string">&quot;电影原名&quot;</span></span><br><span class="line">ws[<span class="string">&quot;D1&quot;</span>] = <span class="string">&quot;其他名称&quot;</span></span><br><span class="line">ws[<span class="string">&quot;E1&quot;</span>] = <span class="string">&quot;年份&quot;</span></span><br><span class="line">ws[<span class="string">&quot;F1&quot;</span>] = <span class="string">&quot;国家&quot;</span></span><br><span class="line">ws[<span class="string">&quot;G1&quot;</span>] = <span class="string">&quot;评分&quot;</span></span><br><span class="line">ws[<span class="string">&quot;H1&quot;</span>] = <span class="string">&quot;简介&quot;</span></span><br><span class="line"></span><br><span class="line">row_num = <span class="number">2</span> <span class="comment">#从第二行开始往里面填充内容</span></span><br><span class="line">last_row_num = <span class="number">2</span> <span class="comment">#用于在上一行填充列元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第一个循环体，按页索引，写在 ?start= 后面</span></span><br><span class="line"><span class="keyword">for</span> start_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">    response = requests.get(<span class="string">f&quot;https://movie.douban.com/top250?start=<span class="subst">&#123;start_num&#125;</span>&quot;</span>, headers=header) <span class="comment">#爬取内容，后面要加上伪装</span></span><br><span class="line">    html = response.text <span class="comment">#得到 HTML 网页，属性为 text</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>) <span class="comment">#通过解析器解析，可以找到各种属性</span></span><br><span class="line"></span><br><span class="line">    all_elements = soup.select(<span class="string">&quot;p, span.title, span.other, span.rating_num, span.inq&quot;</span>) <span class="comment">#选择不同的属性，span.xxx 表示在 span 标签里面的 xxx 类（class）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#第二个循环体，爬取当前页的所有（↑上面标签中的）元素，</span></span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> all_elements:</span><br><span class="line">        <span class="keyword">if</span> element.name == <span class="string">&quot;p&quot;</span>: <span class="comment">#P 标签</span></span><br><span class="line">            text = element.text.strip() <span class="comment">#输出文本，.strip() 是为了去除字符串开头和结尾的空白字符。空白字符包括空格、制表符和换行符等。</span></span><br><span class="line">            <span class="keyword">match</span> = re.search(<span class="string">r&quot;\d&#123;4&#125;\s*/\s*\S+&quot;</span>, text)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                year_country = <span class="keyword">match</span>.group(<span class="number">0</span>)</span><br><span class="line">                year, country = <span class="built_in">map</span>(<span class="built_in">str</span>.strip, year_country.split(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">5</span>, value=year)</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">6</span>, value=country)</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;title&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            title_string = element.string</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> title_string:</span><br><span class="line">                ws.cell(row=row_num, column=<span class="number">2</span>, value=title_string)</span><br><span class="line">                last_row_num = row_num</span><br><span class="line">                row_num += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">3</span>, value=title_string.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">1</span>].strip())</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;other&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            other_string = element.text.strip()</span><br><span class="line">            other_string = re.sub(<span class="string">r&quot;\s*/\s*&quot;</span>, <span class="string">&quot;&quot;</span>, other_string, count=<span class="number">1</span>)</span><br><span class="line">            other_string = re.sub(<span class="string">r&quot;\s+&quot;</span>, <span class="string">&quot;&quot;</span>, other_string)</span><br><span class="line">            ws.cell(row=last_row_num, column=<span class="number">4</span>, value=other_string)</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;rating_num&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            rating_value = <span class="built_in">float</span>(element.string.strip())</span><br><span class="line">            ws.cell(row=last_row_num, column=<span class="number">7</span>, value=rating_value)</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;inq&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            inq_string= element.string.strip()</span><br><span class="line">            ws.cell(row=last_row_num, column=<span class="number">8</span>, value=inq_string)</span><br><span class="line"></span><br><span class="line">wb.save(<span class="string">&quot;douban_top250_26.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>但是！它只显示一个国家，而有的作品制片国家不止一个，有两个三个四个的情况，经过一天的努力，通过任务分解法（先去掉一部分，再去掉一部分，再完成替换），于是有了下面的最终完成版！！！</strong></p>
<h3 id="拓展的最终版（注释完全版）"><a href="#拓展的最终版（注释完全版）" class="headerlink" title="拓展的最终版（注释完全版）"></a>拓展的最终版（注释完全版）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re <span class="comment">#用于正则匹配</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook <span class="comment">#用于生成 Excel 表格</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#加入请求头，伪装成浏览器</span></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Mobile Safari/537.36 Edg/110.0.1587.63&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#表头</span></span><br><span class="line">wb = Workbook()</span><br><span class="line">ws = wb.active</span><br><span class="line">ws.title = <span class="string">&quot;豆瓣电影TOP250&quot;</span> <span class="comment">#这张表格的名字，在左下角显示</span></span><br><span class="line">ws[<span class="string">&quot;A1&quot;</span>] = <span class="string">&quot;序号&quot;</span> <span class="comment">#这一项会比较混乱，不填充，在表格中下拉填充，刚好 250 条</span></span><br><span class="line">ws[<span class="string">&quot;B1&quot;</span>] = <span class="string">&quot;电影名称&quot;</span> <span class="comment">#title</span></span><br><span class="line">ws[<span class="string">&quot;C1&quot;</span>] = <span class="string">&quot;电影原名&quot;</span> <span class="comment">#title→判断带&quot;/&quot;,输出</span></span><br><span class="line">ws[<span class="string">&quot;D1&quot;</span>] = <span class="string">&quot;其他名称&quot;</span> <span class="comment">#other</span></span><br><span class="line">ws[<span class="string">&quot;E1&quot;</span>] = <span class="string">&quot;年份&quot;</span> <span class="comment">#正则匹配 \d&#123;4&#125;</span></span><br><span class="line">ws[<span class="string">&quot;F1&quot;</span>] = <span class="string">&quot;国家&quot;</span> <span class="comment">#正则匹配，通过两次去除，一次替换完成</span></span><br><span class="line">ws[<span class="string">&quot;G1&quot;</span>] = <span class="string">&quot;评分&quot;</span> <span class="comment">#rating_num</span></span><br><span class="line">ws[<span class="string">&quot;H1&quot;</span>] = <span class="string">&quot;简介&quot;</span> <span class="comment">#quote→inq</span></span><br><span class="line"></span><br><span class="line">row_num = <span class="number">2</span> <span class="comment">#从第二行开始往里面填充内容</span></span><br><span class="line">last_row_num = <span class="number">2</span> <span class="comment">#用于在上一行填充列元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第一个循环体，按页索引，写在 ?start= 后面，第一页是 0，第二页是 25……依次类推</span></span><br><span class="line"><span class="keyword">for</span> start_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">    response = requests.get(<span class="string">f&quot;https://movie.douban.com/top250?start=<span class="subst">&#123;start_num&#125;</span>&quot;</span>, headers=header) <span class="comment">#爬取内容，后面要加上伪装</span></span><br><span class="line">    html = response.text <span class="comment">#得到 HTML 网页，属性为 text</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>) <span class="comment">#通过解析器解析，可以找到各种属性</span></span><br><span class="line"></span><br><span class="line">    all_elements = soup.select(<span class="string">&quot;p, span.title, span.other, span.rating_num, span.inq&quot;</span>) <span class="comment">#选择不同的属性，span.xxx 表示在 span 标签里面的 xxx 类（class）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#第二个循环体，爬取当前页的所有（↑上面标签中的）元素，</span></span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> all_elements:</span><br><span class="line">        <span class="keyword">if</span> element.name == <span class="string">&quot;p&quot;</span>: <span class="comment">#判断是否为 P 标签</span></span><br><span class="line">            text = element.text.strip() <span class="comment">#输出文本，.strip() 是为了去除字符串开头和结尾的空白字符。空白字符包括空格、制表符和换行符等。</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">#输出年份</span></span><br><span class="line">            pattern = <span class="string">r&#x27;\d&#123;4&#125;&#x27;</span> <span class="comment">#正则匹配</span></span><br><span class="line">            <span class="keyword">match</span> = re.search(pattern, text)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">match</span>: <span class="comment">#还是要加依据判断，如果有错误会报一下</span></span><br><span class="line">                year = <span class="keyword">match</span>.group(<span class="number">0</span>)</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">5</span>, value=year) <span class="comment">#由于是先输出 title，这里 last_row_num 都表示和 title 在同一行</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">#输出国家</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;\n&#x27;</span> <span class="keyword">in</span> text: <span class="comment">#一开始用了&quot;导演&quot;这个词，匹配到《哈利波特与阿兹卡班的囚徒》时，它的 quote（也是 p 标签）是“不一样的导演，不一样的哈利·波特。”，导致运行下面的代码时匹配不到 \d&#123;4&#125; 等内容，出现报错。通过一步步断点调试才发现这个问题。最后选了一个 \n，表示 &lt;br&gt;，这个在 quote 里面是没有的，因此顺利运行。</span></span><br><span class="line">                <span class="keyword">if</span> title_string != <span class="string">&quot;大闹天宫&quot;</span> <span class="keyword">and</span> title_string != <span class="string">&quot;茶馆&quot;</span>: <span class="comment">#《大闹天宫》和《茶馆》的年份与别的条目都不一样，出现报错。直接 if 语句判断，出现他俩就不输出国家了。</span></span><br><span class="line">                    pattern = <span class="string">r&#x27;\d&#123;4&#125;\s*/\s*(.*)&#x27;</span> <span class="comment">#正则匹配，表示只匹配 \d&#123;4&#125;（指年份）及之后的内容</span></span><br><span class="line">                    <span class="keyword">match</span> = re.search(pattern, text) </span><br><span class="line">                    country = <span class="keyword">match</span>.group(<span class="number">1</span>).split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">0</span>].strip().replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;/&#x27;</span>) <span class="comment">#三行代码简化合并而来：首先是去除 \d&#123;4&#125; 之前的内容，但是通过 group(1)，直接匹配到了 / 后面的内容，这是因为（0）表示整个内容，（1）表示第一个括号里的内容。第二步去除国家 / 后面的内容。第三步把国家之间的空格用 / 代替。</span></span><br><span class="line">                    ws.cell(row=last_row_num, column=<span class="number">6</span>, value=country) <span class="comment">#同样插入与 title 同一行</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;title&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            title_string = element.string</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> title_string:</span><br><span class="line">                ws.cell(row=row_num, column=<span class="number">2</span>, value=title_string)</span><br><span class="line">                last_row_num = row_num</span><br><span class="line">                row_num += <span class="number">1</span> <span class="comment">#注意：全部代码只有这里是加了 1，这是因为它先匹配 title，匹配完后，行数加 1，但是其他的元素都还是用的这一行，即 last_row_num</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ws.cell(row=last_row_num, column=<span class="number">3</span>, value=title_string.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">1</span>].strip())</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;other&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]: <span class="comment">#别名，其他名称</span></span><br><span class="line">            other_string = element.text.strip() <span class="comment">#去掉了字符串两端的空格和换行符，留下了&quot;/ 月黑高飞(港)  /  刺激1995(台)&quot;</span></span><br><span class="line">            other_string = re.sub(<span class="string">r&quot;\s*/\s*&quot;</span>, <span class="string">&quot;&quot;</span>, other_string, count=<span class="number">1</span>) <span class="comment">#这里的正则匹配是用空字符代替第一个 / 及其左右空格，留下了第二个 /：&quot;月黑高飞(港)  /  刺激1995(台)&quot;</span></span><br><span class="line">            other_string = re.sub(<span class="string">r&quot;\s+&quot;</span>, <span class="string">&quot;&quot;</span>, other_string) <span class="comment">#这里的正则匹配是用空字符代替所有空格，刚好使 / 留下：&quot;月黑高飞(港)/刺激1995(台)&quot;</span></span><br><span class="line">            ws.cell(row=last_row_num, column=<span class="number">4</span>, value=other_string)</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;rating_num&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            rating_value = <span class="built_in">float</span>(element.string.strip()) <span class="comment">#这里用不用 float 都是可以的，无所谓</span></span><br><span class="line">            ws.cell(row=last_row_num, column=<span class="number">7</span>, value=rating_value)</span><br><span class="line">        <span class="keyword">elif</span> element.name == <span class="string">&quot;span&quot;</span> <span class="keyword">and</span> <span class="string">&quot;inq&quot;</span> <span class="keyword">in</span> element[<span class="string">&quot;class&quot;</span>]:</span><br><span class="line">            inq_string= element.string.strip() <span class="comment">#去除字符串两端的空格和换行符</span></span><br><span class="line">            ws.cell(row=last_row_num, column=<span class="number">8</span>, value=inq_string)</span><br><span class="line"></span><br><span class="line">wb.save(<span class="string">&quot;douban_top250_1.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>算下来花了有两天的功夫，其中昨天（2023&#x2F;03&#x2F;09）上午跟着 Up 主学，下午开始写拓展，到了晚上的时候完成。结果快下班的时候发现了<strong>国家和地区</strong>那里出了问题，一开始想一行代码就完成正则匹配，奈何一直无解，困扰了今天（2023&#x2F;03&#x2F;10）一整个上午。下午去车管所回来四点，更新了思路，一步一步实现。又遇到了<strong>大闹天宫</strong>、<strong>茶馆</strong>年份和别的条目不太一样的问题，让师弟看了一下，加了 if 判断，搞定！然后又遇到了<strong>哈利波特与阿兹卡班的囚徒</strong>那里报错，原来是它的 quote 里面有<strong>导演</strong>这个词，引用就进入了国家的条目，匹配不到，就报错，换了 <strong>\n</strong> 解决了问题！断点调试流程如下图。（<span style = "background:#f9eda6;">刚刚想起来</span>：年份那里有个 if 判断，而我在国家那里没有加，所以才报错！换成下面的代码就不报错了，即使用<strong>导演</strong>也没有关系。哎呀，被自己蠢到。）</p>
<img src="https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/image-20230310225805166.png" alt="image-20230310225805166" style="zoom:80%;" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#输出国家</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;导演&#x27;</span> <span class="keyword">in</span> text: </span><br><span class="line">    <span class="keyword">if</span> title_string != <span class="string">&quot;大闹天宫&quot;</span> <span class="keyword">and</span> title_string != <span class="string">&quot;茶馆&quot;</span>: </span><br><span class="line">        pattern = <span class="string">r&#x27;\d&#123;4&#125;\s*/\s*(.*)&#x27;</span> </span><br><span class="line">        <span class="keyword">match</span> = re.search(pattern, text) </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            country = <span class="keyword">match</span>.group(<span class="number">1</span>).split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">0</span>].strip().replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">            ws.cell(row=last_row_num, column=<span class="number">6</span>, value=country)</span><br></pre></td></tr></table></figure>

<img src="https://storybeginswhenicu.oss-cn-hangzhou.aliyuncs.com/img/image-20230310213947277.png" alt="image-20230310213947277" style="zoom:45.5%;" />

<p>完结撒花✿✿ヽ(°▽°)ノ✿✿</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ol>
<li><a class="link"   target="_blank" rel="noopener" href="https://b23.tv/svWjQBz" >https://b23.tv/svWjQBz<i class="fas fa-external-link-alt"></i></a></li>
</ol>

            </div>

            
                <div class="post-copyright-info">
                    
<div class="article-copyright-info-container">
    <ul class="copyright-info-content">
        <li class="post-title">
            <span class="type">本文标题</span>：<span class="content">Python 爬虫入门</span>
        </li>
        <li class="post-author">
            <span class="type">本文作者</span>：<span class="content">XiaoMa</span>
        </li>
        <li class="post-time">
            <span class="type">创建时间</span>：<span class="content">2023-03-09 11:13:09</span>
        </li>
        <li class="post-link">
            <span class="type">本文链接</span>：<span class="content">2023/03/09/035-Python-爬虫入门/</span>
        </li>
        <li class="post-license">
            <span class="type">版权声明</span>：<span class="content">本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！</span>
        </li>
    </ul>
    <div class="copy-copyright-info flex-center tooltip" data-content="复制版权信息" data-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/%E7%88%AC%E8%99%AB/">#爬虫</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/%E8%B1%86%E7%93%A3/">#豆瓣</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2023/03/12/036-ADB-%E4%B8%8E-Anaconda-%E4%BD%BF%E7%94%A8/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">ADB 与 Anaconda 使用</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/03/08/034-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8-HTML-%E8%AF%AD%E8%A8%80/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">快速入门 HTML 语言</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E7%BB%83%E4%B9%A0%EF%BC%9A%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1-TOP250"><span class="nav-number">1.</span> <span class="nav-text">实战练习：豆瓣电影 TOP250</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="nav-number">2.</span> <span class="nav-text">实现步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%93%E5%B1%95%E7%BB%83%E4%B9%A0"><span class="nav-number">3.</span> <span class="nav-text">拓展练习</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A0%E5%85%A5%E4%BA%86%E7%94%B5%E5%BD%B1%E5%8E%9F%E5%90%8D%EF%BC%88%E7%AC%AC-3-%E5%88%97%EF%BC%89"><span class="nav-number">3.1.</span> <span class="nav-text">加入了电影原名（第 3 列）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%88%E5%8A%A0%E5%85%A5%E4%BA%86%E5%88%AB%E5%90%8D%EF%BC%88%E7%AC%AC-4-%E5%88%97%EF%BC%89"><span class="nav-number">3.2.</span> <span class="nav-text">又加入了别名（第 4 列）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%88%E5%8A%A0%E5%85%A5%E4%BA%86%E5%B9%B4%E4%BB%BD%E3%80%81%E5%9B%BD%E5%AE%B6%EF%BC%88%E7%AC%AC-5%E3%80%816-%E5%88%97%EF%BC%89"><span class="nav-number">3.3.</span> <span class="nav-text">又加入了年份、国家（第 5、6 列）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%88%E5%8A%A0%E5%85%A5%E4%BA%86%E7%AE%80%E4%BB%8B%EF%BC%88%E7%AC%AC-7-%E5%88%97%EF%BC%89"><span class="nav-number">3.4.</span> <span class="nav-text">又加入了简介（第 7 列）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%93%E5%B1%95%E7%9A%84%E6%9C%80%E7%BB%88%E7%89%88%EF%BC%88%E6%B3%A8%E9%87%8A%E5%AE%8C%E5%85%A8%E7%89%88%EF%BC%89"><span class="nav-number">4.</span> <span class="nav-text">拓展的最终版（注释完全版）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">5.</span> <span class="nav-text">参考</span></a></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2022</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">XiaoMa</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script>




<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script>
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script>
        
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script>
        
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
